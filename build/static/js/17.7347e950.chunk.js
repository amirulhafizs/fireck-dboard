(this["webpackJsonpfireck-cms"]=this["webpackJsonpfireck-cms"]||[]).push([[17],{1026:function(e,t,n){"use strict";n.r(t);var c=n(17),r=n(1),a=n.n(r),s=n(5),i=n(19),o=n(12),l=n(814),d=n(53),u=n(0),f=n.n(u),b=n(999),j=["find","find one","count","create","update","delete","type"],h=n(174),m=n(954),x=n.n(m),p=n(2),v=function(e){var t=e.roleCopy,n=e.collections,r=e.setRoleCopy,a=function(e,t){return e>t?1:e<t?-1:0};return t?Object(p.jsx)("div",{className:"h-full bg-white rounded overflow-hidden",children:Object(p.jsx)(h.a,{className:"pb-2 scrollbar-light h-full",children:Object(p.jsxs)("table",{className:"w-full min-w-544px",children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{className:"text-center bg-gray-E1E1E1 sticky top-0 z-10"}),Object(p.jsxs)("th",{className:"text-center font-semibold bg-gray-E1E1E1 sticky top-0 z-10",children:[Object(p.jsx)("div",{className:"opacity-0",children:"All"}),Object(p.jsx)(b.a,{size:"small",classes:{checked:"text-fireck-1",root:"p-0"},checked:!n.find((function(e){return!t.permissions[e.docId]||t.permissions[e.docId].length<j.length})),onChange:function(e){return function(e){if(t){var s=Object(c.a)({},t.permissions);e?n.forEach((function(e){s[e.docId]=j,s[e.docId].sort(a)})):s={},r((function(e){return e?Object(c.a)(Object(c.a)({},e),{},{permissions:s}):e}))}}(e.target.checked)}})]}),j.map((function(e,s){return Object(p.jsxs)("th",{className:"font-semibold sticky top-0 bg-gray-E1E1E1 z-10",children:[Object(p.jsx)("div",{children:e}),Object(p.jsx)(b.a,{size:"small",classes:{checked:"text-fireck-1",root:"p-0"},checked:!n.find((function(n){var c;return!(null===(c=t.permissions[n.docId])||void 0===c?void 0:c.includes(e))})),onChange:function(s){return function(e,s){if(t){var i=Object(c.a)({},t.permissions),o=Object.keys(i);n.forEach((function(t){e?o.includes(t.docId)?i[t.docId].includes(s)||(i[t.docId].push(s),i[t.docId].sort(a)):i[t.docId]=[s]:o.includes(t.docId)&&i[t.docId].includes(s)&&(i[t.docId]=i[t.docId].filter((function(e){return e!==s})))})),r((function(e){return e?Object(c.a)(Object(c.a)({},e),{},{permissions:i}):e}))}}(s.target.checked,e)}})]},e)}))]})}),Object(p.jsx)("tbody",{children:n.map((function(e,n){return Object(p.jsxs)("tr",{className:"hover:bg-fireck-4",children:[Object(p.jsx)("td",{children:Object(p.jsxs)("div",{className:" max-w-160px truncate pl-2 capitalize flex items-center",children:[e.isSystem?Object(p.jsx)(x.a,{fontSize:"inherit",className:"text-sm mr-1"}):null,e.name]})}),Object(p.jsx)("td",{className:"text-center",children:Object(p.jsx)(b.a,{size:"small",classes:{checked:"text-fireck-1",root:"p-0"},checked:!!t.permissions[e.docId]&&t.permissions[e.docId].length===j.length,onChange:function(n){return function(e,n){if(t){var a=Object(c.a)({},t.permissions);a[n]=e?j:[],r((function(e){return e?Object(c.a)(Object(c.a)({},e),{},{permissions:a}):e}))}}(n.target.checked,e.docId)}})}),j.map((function(n,s){return Object(p.jsx)("td",{className:"text-center",children:Object(p.jsx)(b.a,{size:"small",classes:{checked:"text-fireck-1",root:"p-0"},checked:!!t.permissions[e.docId]&&t.permissions[e.docId].includes(n),onChange:function(t){return r((function(r){if(null==r)return r;var s=t.target.checked,i=Object(c.a)({},r.permissions);if(s)e.docId in i?(i[e.docId].push(n),i[e.docId].sort(a)):i[e.docId]=[n];else if(e.docId in i){var o=i[e.docId].findIndex((function(e){return e===n}));i[e.docId].splice(o,1),i[e.docId].length||delete i[e.docId]}return Object(c.a)(Object(c.a)({},r),{},{permissions:i})}))}})},n+e.docId)}))]},e.docId)}))})]})})}):null},O=n(788),g=n(104),k=n(175),y=n(1025),w=n(298),N=n.n(w),I=function(e){var t=e.open,n=e.onClose,c=e.editRole,r=e.onDelete,o=e.onSave,l=e.onCreate,u=Object(k.a)({onSubmit:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.docId){e.next=5;break}return e.next=3,o(t);case 3:e.next=7;break;case 5:return e.next=7,l(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),enableReinitialize:!0,initialValues:c||{name:"",defaultPermissions:[],permissions:{},docId:""},validate:function(e){var t={};return 0===e.name.length&&(t.name="required"),t}}),f=u.values,h=u.errors,m=u.isSubmitting,x=u.submitCount,v=u.handleChange,w=u.setFieldValue,I=u.handleSubmit;return t?Object(p.jsx)(O.a,{open:t,hideBackdrop:!0,children:Object(p.jsx)("div",{className:"w-full h-full flex overflow-auto bg-black bg-opacity-40 p-7",children:Object(p.jsxs)("div",{style:{maxWidth:570},className:"m-auto rounded bg-white w-full p-7 animate-littlemoveup relative",children:[Object(p.jsx)(N.a,{className:"absolute top-0 right-0 cursor-pointer",onClick:n}),Object(p.jsx)("div",{className:"mb-9 font-medium text-2xl",children:f.docId?"Edit role":"Create role"}),Object(p.jsxs)("div",{className:"mb-9",children:[Object(p.jsx)("div",{className:"mb-2",children:"Role name"}),Object(p.jsx)(g.a,{className:"h-34px",groundColor:"white",disabled:["public","authenticated"].includes(f.name),onChange:v,name:"name",value:f.name,error:!!(h.name&&x>0)&&h.name})]}),Object(p.jsx)("div",{className:"mb-2",children:"Default permissions"}),Object(p.jsx)("div",{className:"flex flex-wrap mb-9",children:j.map((function(e,t){return Object(p.jsx)("div",{className:"sm:w-1/3 w-1/2 flex",children:Object(p.jsx)(y.a,{classes:{label:"font-poppins line-clamp-1"},control:Object(p.jsx)(b.a,{classes:{checked:"text-fireck-1"},className:"mr-3",checked:f.defaultPermissions.includes(e),onChange:function(t){var n=Object(i.a)(f.defaultPermissions);if(t.target.checked)n.push(e);else{var c=n.findIndex((function(t){return t===e}));n.splice(c,1)}w("defaultPermissions",n)}}),label:e})},e)}))}),!c||["public","authenticated"].includes(c.name.toLowerCase())?null:Object(p.jsx)(d.a,{onClick:function(){return r(c.docId)},className:"border-2 h-34px border-red-FF0000 text-red-FF0000 mb-10 hover:bg-red-FF0000 hover:text-white",children:"Delete role"}),Object(p.jsxs)("div",{className:"flex justify-between",children:[Object(p.jsx)(d.a,{onClick:function(){return n()},className:"bg-fireck-5 hover:bg-fireck-5-hover text-white h-34px",children:"Cancel"}),Object(p.jsx)(d.a,{onClick:function(){return I()},className:"bg-fireck-4 hover:bg-fireck-4-hover h-34px",children:m?"Loading...":"Submit"})]})]})})}):null},C=n(225),S=n(37),E=n(91),z=n(173),R=n(102),F=n.n(R);t.default=function(){var e=f.a.useState(!1),t=Object(o.a)(e,2),n=t[0],r=t[1],u=f.a.useState([]),b=Object(o.a)(u,2),j=b[0],h=b[1],m=f.a.useState(""),x=Object(o.a)(m,2),O=x[0],g=x[1],k=f.a.useState(),y=Object(o.a)(k,2),w=y[0],N=y[1],R=Object(S.e)((function(e){return[].concat(Object(i.a)(e.collectionTypes.filter((function(e){return e.isSystem}))),Object(i.a)(e.collectionTypes.filter((function(e){return!e.isSystem}))))})),L=Object(E.b)(),P=Object(S.d)(),_=f.a.useState(),A=Object(o.a)(_,2),D=A[0],M=A[1],J=f.a.useState(!1),T=Object(o.a)(J,2),B=T[0],G=T[1],H=j.find((function(e){return e.docId===O})),V=!(JSON.stringify(H)===JSON.stringify(D));f.a.useEffect((function(){H&&M(JSON.parse(JSON.stringify(H)))}),[H]),f.a.useEffect((function(){Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!P){e.next=7;break}return P({type:"SET_LOADING",payload:!0}),e.next=5,Object(C.c)({collectionId:"RolesReservedCollection"});case 5:"error"in(t=e.sent)||(h(t),t.length&&g(t[0].docId));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:return e.prev=12,P({type:"SET_LOADING",payload:!1}),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})))()}),[P]),f.a.useEffect((function(){w&&r(!0)}),[w]);var q=function(){r(!1),N(void 0)},W=function(){var e=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(C.e)("RolesReservedCollection",t.docId,t);case 2:"error"in(n=e.sent)?L(n.error,{variant:"error"}):(h((function(e){var n=Object(i.a)(e),c=n.findIndex((function(e){return e.docId===O}));return-1===c||(n[c]=t),n})),L("Role updated!",{variant:"success"})),q();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(C.a)("RolesReservedCollection",t);case 2:"error"in(n=e.sent)?L(n.error,{variant:"error"}):(h((function(e){return[Object(c.a)(Object(c.a)({},t),{},{docId:n.docId})].concat(Object(i.a)(e))})),L("Role created!",{variant:"success"})),q();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(z.a)({confirmation:"Do you really want to delete this role"});case 2:if(!e.sent){e.next=8;break}return e.next=5,Object(C.b)("RolesReservedCollection",t);case 5:e.sent.error?L("Role was not deleted",{variant:"error"}):(h((function(e){var n=Object(i.a)(e),c=n.findIndex((function(e){return e.docId===t}));return-1===c?e:(n.splice(c,1),n)})),L("Role deleted!",{variant:"success"})),q();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return console.log("role updated"),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(I,{onCreate:K,onDelete:Q,editRole:w,open:n,onSave:W,onClose:function(){r(!1),N(void 0)}}),Object(p.jsx)(l.a,{selectedEntityId:O,entity:"role",enitityPlural:"roles",onAddEntity:function(){return r(!0)},entities:j,entityButtons:Object(p.jsx)(d.a,{onClick:Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=2;break}return e.abrupt("return");case 2:return G(!0),e.next=5,W(D);case 5:G(!1);case 6:case"end":return e.stop()}}),e)}))),disabled:!V||B,className:F()("mb-4 min-w-unset h-28px px-7",{"bg-white cursor-default text-gray-500":!V&&!B,"bg-fireck-4 hover:bg-fireck-4-hover":!(!V&&!B)}),children:B?"Saving...":V?"Save":"Saved!"}),onSelectEntity:function(e){g(e)},onInvokeEntityEdit:function(){return N(H)},entityContent:Object(p.jsx)(v,{collections:R,roleCopy:D,setRoleCopy:M})})]})}},797:function(e,t,n){"use strict";var c=n(172),r=n(17),a=n(808),s=n(739),i=n(0),o=n.n(i),l=n(102),d=n.n(l),u=n(2),f=["className","options","error","groundColor"],b=o.a.forwardRef((function(e,t){return Object(u.jsx)("div",Object(r.a)(Object(r.a)({},e),{},{ref:t,children:Object(u.jsx)(a.a,{className:"text-red-FF0000",size:20})}))}));t.a=function(e){var t=e.className,n=void 0===t?"":t,a=e.options,i=e.error,o=e.groundColor,l=Object(c.a)(e,f);return Object(u.jsxs)("div",{className:"".concat(n," relative flex items-center"),children:[Object(u.jsx)("select",Object(r.a)(Object(r.a)({className:d()("px-3 h-full border-2 border-solid w-full rounded outline-none",{"border-red-FF0000":i,"focus:border-fireck-4":!i,"border-gray-300 bg-gray-300":"white"===o,"border-white bg-white":"black"===o})},l),{},{spellCheck:!1,children:a.map((function(e,t){return Object(u.jsx)("option",{"data-testid":"select-option-".concat(e.value),value:e.value,children:e.label},"opt-"+t)}))})),i?Object(u.jsx)(s.a,{title:i,placement:"top",children:Object(u.jsx)(b,{className:"absolute right-2 my-auto w-auto"})}):null]})}},810:function(e,t,n){"use strict";var c=n(63),r=n(226);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(0)),s=(0,c(n(227)).default)(a.createElement("path",{d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"EditRounded");t.default=s},814:function(e,t,n){"use strict";var c=n(12),r=n(53),a=n(0),s=n.n(a),i=n(810),o=n.n(i),l=n(797),d=n(174),u=n(802),f=n.n(u),b=n(820),j=n.n(b),h=n(2),m=s.a.memo((function(e){var t,n=e.entity,s=e.enitityPlural,i=e.onAddEntity,u=e.entities,b=e.onSelectEntity,m=e.entityButtons,x=e.onInvokeEntityEdit,p=e.entityContent,v=e.selectedEntityId,O=Object(a.useState)(""),g=Object(c.a)(O,2),k=g[0],y=g[1];return Object(h.jsxs)("div",{className:"h-full flex flex-col",children:[Object(h.jsxs)("div",{className:"flex flex-wrap justify-between mb-4",children:[Object(h.jsx)("div",{className:"font-medium text-27px leading-none mb-4 mr-4 text-white capitalize",children:s}),i?Object(h.jsx)(r.a,{"data-testid":"add-collection-btn",onClick:i,className:"bg-fireck-4 hover:bg-fireck-4-hover mb-4 min-w-unset",children:Object(h.jsxs)("div",{className:"flex items-center pointer-events-none h-34px",children:[Object(h.jsx)(f.a,{className:"mr-2 text-lg",fontSize:"inherit"}),Object(h.jsxs)("span",{className:"hidden md:block",children:["Add ",n]}),Object(h.jsx)("span",{className:"md:hidden",children:"Add"})]})}):null]}),u.length?Object(h.jsxs)("div",{className:"flex flex-wrap lg:flex-nowrap w-full flex-grow",children:[Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"relative mr-4 hidden lg:block",style:{width:180},children:[Object(h.jsx)(j.a,{fontSize:"inherit",className:"absolute text-base left-1 top-1 text-gray-500 pointer-events-none"}),Object(h.jsx)("input",{type:"search",spellCheck:!1,placeholder:"Search",className:"text-white placeholder-gray-500 pl-7 hover:bg-fireck-2 focus:bg-fireck-2 w-full text-sm mb-3 px-2 border-white rounded bg-transparent outline-none focus:outline-none",value:k,onChange:function(e){return y(e.target.value)}})]}),Object(h.jsx)(d.a,{style:{maxHeight:230},className:"max-w-192px w-full flex-shrink-0 mr-4 hidden lg:block scrollbar-dark pr-3",autoHide:!1,children:u.filter((function(e){return!k||e.name.toLowerCase().includes(k.toLowerCase())})).map((function(e){return Object(h.jsx)("div",{"data-testid":"entity-name-".concat(e.name),onClick:function(){b(e.docId)},className:"mb-1 capitalize truncate select-none cursor-pointer ".concat(v===e.docId?"bg-fireck-4":"hover:bg-fireck-1-hover text-white"," rounded h-28px leading-28px px-3"),children:e.name},"entity-".concat(e.docId))}))})]}),Object(h.jsxs)("div",{className:"lg:flex-grow w-full rounded-lg bg-fireck-3 p-7 flex flex-col",children:[Object(h.jsxs)("div",{className:"flex justify-between mb-3 flex-wrap",children:[Object(h.jsxs)("div",{className:"font-medium text-22px capitalize mb-3 mr-3 text-white",children:[Object(h.jsx)("span",{className:"hidden lg:inline-block",children:(null===(t=u.find((function(e){return e.docId===v})))||void 0===t?void 0:t.name)||""}),Object(h.jsx)("div",{className:"lg:hidden inline-block text-black text-base",children:Object(h.jsx)(l.a,{className:"h-28px",groundColor:"black",onChange:function(e){return b(e.target.value)},value:v,options:u.map((function(e){return{label:e.name,value:e.docId}}))})}),x?Object(h.jsx)(o.a,{"data-testid":"edit-collection-btn",onClick:x,className:"ml-3 text-lg cursor-pointer",fontSize:"inherit"}):null]}),m]}),Object(h.jsx)("div",{className:"flex-grow h-0",children:p})]})]}):Object(h.jsx)("div",{})]})}));t.a=m},820:function(e,t,n){"use strict";var c=n(63),r=n(226);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(0)),s=(0,c(n(227)).default)(a.createElement("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"SearchRounded");t.default=s},954:function(e,t,n){"use strict";var c=n(63);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n(81)),a=n(2),s=(0,r.default)((0,a.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star");t.default=s}}]);
//# sourceMappingURL=17.7347e950.chunk.js.map