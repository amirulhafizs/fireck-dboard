(this["webpackJsonpfireck-cms"]=this["webpackJsonpfireck-cms"]||[]).push([[15],{724:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l}));var c=n(13),r=function(){var e=c.b.getState().user;return"Bearer "+(e?e.token:null)},a=function(e,t){var n=e.collectionId,c=e.orderBy,a=e.startAt,i=e.startAfter,o=e.where,s=e.limit,l=void 0===s?10:s,d=e.populateRef,u=void 0===d||d,f="".concat(window.location.origin,"/api/").concat(n,"?limit=").concat(l,"&populateRef=").concat(u).concat(c?"&orderBy=".concat(c):"").concat(a?"&startAt=".concat(a):i?"&startAfter=".concat(i):"").concat(o?"&where=".concat(o):"");return fetch(f,{headers:{Authorization:r()},signal:t}).then((function(e){return e.json()})).catch((function(e){return e.code&&20===e.code?{error:"aborted"}:{error:e.toString()}}))},i=function(e,t){try{return fetch(window.location.origin+"/api/".concat(e),{method:"POST",headers:{Authorization:r()},body:JSON.stringify(t)}).then((function(e){return e.json()}))}catch(n){return{error:n}}},o=function(e,t){try{return fetch(window.location.origin+"/api/".concat(e,"/").concat(t),{method:"DELETE",headers:{Authorization:r()}}).then((function(e){return e.json()}))}catch(n){return{error:n}}},s=function(e,t){try{return fetch(window.location.origin+"/api/".concat(e).concat(t?"/".concat(t):"","?populateRef=false"),{headers:{Authorization:r()}}).then((function(e){return e.json()}))}catch(n){return{error:n}}},l=function(e,t,n){try{return fetch(window.location.origin+"/api/".concat(e,"/").concat(t),{method:"PUT",headers:{Authorization:r()},body:JSON.stringify(n)}).then((function(e){return e.json()}))}catch(c){return{error:c}}}},725:function(e,t,n){"use strict";var c=n(142),r=n(10),a=n(743),i=n(674),o=n(0),s=n.n(o),l=n(88),d=n.n(l),u=n(1),f=s.a.forwardRef((function(e,t){return Object(u.jsx)("div",Object(r.a)(Object(r.a)({},e),{},{ref:t,children:Object(u.jsx)(a.a,{className:"text-red-FF0000",size:20})}))}));t.a=function(e){var t=e.className,n=void 0===t?"":t,a=e.options,o=e.error,s=e.groundColor,l=Object(c.a)(e,["className","options","error","groundColor"]);return Object(u.jsxs)("div",{className:"".concat(n," relative flex items-center"),children:[Object(u.jsx)("select",Object(r.a)(Object(r.a)({className:d()("px-3 h-full border-2 border-solid w-full rounded outline-none",{"border-red-FF0000":o,"focus:border-fireck-4":!o,"border-gray-300 bg-gray-300":"white"===s,"border-white bg-white":"black"===s})},l),{},{spellCheck:!1,children:a.map((function(e,t){return Object(u.jsx)("option",{"data-testid":"select-option-".concat(e.value),value:e.value,children:e.label},"opt-"+t)}))})),o?Object(u.jsx)(i.a,{title:o,placement:"top",children:Object(u.jsx)(f,{className:"absolute right-2 my-auto w-auto"})}):null]})}},733:function(e,t,n){"use strict";var c=n(45),r=n(46);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(0)),i=(0,c(n(47)).default)(a.createElement("path",{d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"EditRounded");t.default=i},745:function(e,t,n){"use strict";n(5);var c=n(39),r=(n(0),n(733)),a=n.n(r),i=n(725),o=n(143),s=n(727),l=n.n(s),d=n(1);t.a=function(e){var t,n=e.entity,r=e.enitityPlural,s=e.onAddEntity,u=e.entities,f=e.onSelectEntity,b=e.entityButtons,h=e.onInvokeEntityEdit,j=e.entityContent,m=e.selectedEntityId;return Object(d.jsxs)("div",{className:"h-full flex flex-col",children:[Object(d.jsxs)("div",{className:"flex flex-wrap justify-between mb-4",children:[Object(d.jsx)("div",{className:"font-medium text-27px leading-none mb-4 mr-4 text-white capitalize",children:r}),s?Object(d.jsx)(c.a,{noMinWidth:!0,"data-testid":"add-collection-btn",onClick:s,className:"bg-fireck-4 hover:bg-fireck-4-hover mb-4",children:Object(d.jsxs)("div",{className:"flex items-center pointer-events-none h-34px",children:[Object(d.jsx)(l.a,{className:"mr-2 text-lg",fontSize:"inherit"}),Object(d.jsxs)("span",{className:"hidden md:block",children:["Add ",n]}),Object(d.jsx)("span",{className:"md:hidden",children:"Add"})]})}):null]}),u.length?Object(d.jsxs)("div",{className:"flex flex-wrap lg:flex-nowrap w-full flex-grow",children:[Object(d.jsx)(o.a,{className:"max-w-192px w-full flex-shrink-0 mr-4 hidden lg:block max-h-96 scrollbar-dark pr-3",autoHide:!1,children:u.map((function(e){return Object(d.jsx)("div",{"data-testid":"entity-name-".concat(e.name),onClick:function(){f(e.docId)},className:"mb-1 capitalize truncate select-none cursor-pointer ".concat(m===e.docId?"bg-fireck-4":"hover:bg-fireck-1-hover text-white"," rounded h-28px leading-28px px-3"),children:e.name},"entity-".concat(e.docId))}))}),Object(d.jsxs)("div",{className:"lg:flex-grow w-full rounded-lg bg-fireck-3 p-7 flex flex-col",children:[Object(d.jsxs)("div",{className:"flex justify-between mb-3 flex-wrap",children:[Object(d.jsxs)("div",{className:"font-medium text-22px capitalize mb-3 mr-3 text-white",children:[Object(d.jsx)("span",{className:"hidden lg:inline-block",children:(null===(t=u.find((function(e){return e.docId===m})))||void 0===t?void 0:t.name)||""}),Object(d.jsx)("div",{className:"lg:hidden inline-block text-black text-base",children:Object(d.jsx)(i.a,{className:"h-28px",groundColor:"black",onChange:function(e){return f(e.target.value)},value:m,options:u.map((function(e){return{label:e.name,value:e.docId}}))})}),h?Object(d.jsx)(a.a,{"data-testid":"edit-collection-btn",onClick:h,className:"ml-3 text-lg cursor-pointer",fontSize:"inherit"}):null]}),b]}),Object(d.jsx)("div",{className:"flex-grow h-0",children:j})]})]}):Object(d.jsx)("div",{})]})}},933:function(e,t,n){"use strict";n.r(t);var c=n(10),r=n(19),a=n(7),i=n.n(a),o=n(14),s=n(5),l=n(745),d=n(39),u=n(0),f=n.n(u),b=n(916),h=["find","find one","count","create","update","delete","type"],j=n(143),m=n(1),x=function(e){var t=e.roleCopy,n=e.collections,r=e.setRoleCopy,a=function(e,t){return e>t?1:e<t?-1:0};return t?Object(m.jsx)("div",{className:"h-full bg-white rounded overflow-hidden",children:Object(m.jsx)(j.a,{className:"pb-2 scrollbar-light h-full",children:Object(m.jsxs)("table",{className:"w-full min-w-544px",children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{className:"text-center bg-gray-E1E1E1 sticky top-0 z-10"}),Object(m.jsxs)("th",{className:"text-center font-semibold bg-gray-E1E1E1 sticky top-0 z-10",children:[Object(m.jsx)("div",{children:"All"}),Object(m.jsx)(b.a,{size:"small",classes:{checked:"text-fireck-1",root:"p-0"},checked:!n.find((function(e){return!t.permissions[e.docId]||t.permissions[e.docId].length<h.length})),onChange:function(e){return function(e){if(t){var i=Object(c.a)({},t.permissions);e?n.forEach((function(e){i[e.docId]=h,i[e.docId].sort(a)})):i={},r((function(e){return e?Object(c.a)(Object(c.a)({},e),{},{permissions:i}):e}))}}(e.target.checked)}})]}),h.map((function(e,i){return Object(m.jsxs)("th",{className:"font-semibold sticky top-0 bg-gray-E1E1E1 z-10",children:[Object(m.jsx)("div",{children:e}),Object(m.jsx)(b.a,{size:"small",classes:{checked:"text-fireck-1",root:"p-0"},checked:!n.find((function(n){var c;return!(null===(c=t.permissions[n.docId])||void 0===c?void 0:c.includes(e))})),onChange:function(i){return function(e,i){if(t){var o=Object(c.a)({},t.permissions),s=Object.keys(o);n.forEach((function(t){e?s.includes(t.docId)?o[t.docId].includes(i)||(o[t.docId].push(i),o[t.docId].sort(a)):o[t.docId]=[i]:s.includes(t.docId)&&o[t.docId].includes(i)&&(o[t.docId]=o[t.docId].filter((function(e){return e!==i})))})),r((function(e){return e?Object(c.a)(Object(c.a)({},e),{},{permissions:o}):e}))}}(i.target.checked,e)}})]},e)}))]})}),Object(m.jsx)("tbody",{children:n.map((function(e,n){return Object(m.jsxs)("tr",{className:"hover:bg-fireck-4",children:[Object(m.jsx)("td",{children:Object(m.jsx)("div",{className:"max-w-135px truncate pl-2 capitalize",children:e.name})}),Object(m.jsx)("td",{className:"text-center",children:Object(m.jsx)(b.a,{size:"small",classes:{checked:"text-fireck-1",root:"p-0"},checked:!!t.permissions[e.docId]&&t.permissions[e.docId].length===h.length,onChange:function(n){return function(e,n){if(t){var a=Object(c.a)({},t.permissions);a[n]=e?h:[],r((function(e){return e?Object(c.a)(Object(c.a)({},e),{},{permissions:a}):e}))}}(n.target.checked,e.docId)}})}),h.map((function(n,i){return Object(m.jsx)("td",{className:"text-center",children:Object(m.jsx)(b.a,{size:"small",classes:{checked:"text-fireck-1",root:"p-0"},checked:!!t.permissions[e.docId]&&t.permissions[e.docId].includes(n),onChange:function(t){return r((function(r){if(null==r)return r;var i=t.target.checked,o=Object(c.a)({},r.permissions);if(i)e.docId in o?(o[e.docId].push(n),o[e.docId].sort(a)):o[e.docId]=[n];else if(e.docId in o){var s=o[e.docId].findIndex((function(e){return e===n}));o[e.docId].splice(s,1),o[e.docId].length||delete o[e.docId]}return Object(c.a)(Object(c.a)({},r),{},{permissions:o})}))}})},n+e.docId)}))]},e.docId)}))})]})})}):null},p=n(713),v=n(89),O=n(145),g=n(932),k=n(99),w=n.n(k),y=function(e){var t=e.open,n=e.onClose,c=e.editRole,a=e.onDelete,s=e.onSave,l=e.onCreate,u=Object(O.a)({onSubmit:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.docId){e.next=5;break}return e.next=3,s(t);case 3:e.next=7;break;case 5:return e.next=7,l(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),enableReinitialize:!0,initialValues:c||{name:"",defaultPermissions:[],permissions:{},docId:""},validate:function(e){var t={};return 0===e.name.length&&(t.name="required"),t}}),f=u.values,j=u.errors,x=u.isSubmitting,k=u.submitCount,y=u.handleChange,N=u.setFieldValue,I=u.handleSubmit;return t?Object(m.jsx)(p.a,{open:t,hideBackdrop:!0,children:Object(m.jsx)("div",{className:"w-full h-full flex overflow-auto bg-black bg-opacity-40 p-7",children:Object(m.jsxs)("div",{style:{maxWidth:570},className:"m-auto rounded bg-white w-full p-7 animate-littlemoveup relative",children:[Object(m.jsx)(w.a,{className:"absolute top-0 right-0 cursor-pointer",onClick:n}),Object(m.jsx)("div",{className:"mb-9 font-medium text-2xl",children:f.docId?"Edit role":"Create role"}),Object(m.jsxs)("div",{className:"mb-9",children:[Object(m.jsx)("div",{className:"mb-2",children:"Role name"}),Object(m.jsx)(v.a,{className:"h-34px",groundColor:"white",disabled:["public","authenticated"].includes(f.name),onChange:y,name:"name",value:f.name,error:!!(j.name&&k>0)&&j.name})]}),Object(m.jsx)("div",{className:"mb-2",children:"Default permissions"}),Object(m.jsx)("div",{className:"flex flex-wrap mb-9",children:h.map((function(e,t){return Object(m.jsx)("div",{className:"sm:w-1/3 w-1/2 flex",children:Object(m.jsx)(g.a,{classes:{label:"font-poppins line-clamp-1"},control:Object(m.jsx)(b.a,{classes:{checked:"text-blue-300"},className:"mr-3",checked:f.defaultPermissions.includes(e),onChange:function(t){var n=Object(r.a)(f.defaultPermissions);if(t.target.checked)n.push(e);else{var c=n.findIndex((function(t){return t===e}));n.splice(c,1)}N("defaultPermissions",n)}}),label:e})},e)}))}),!c||["public","authenticated"].includes(c.name.toLowerCase())?null:Object(m.jsx)(d.a,{onClick:function(){return a(c.docId)},className:"border-2 h-34px border-red-FF0000 text-red-FF0000 mb-10 hover:bg-red-FF0000 hover:text-white",children:"Delete role"}),Object(m.jsxs)("div",{className:"flex justify-between",children:[Object(m.jsx)(d.a,{onClick:function(){return n()},className:"bg-blue-300 hover:bg-blue-400 text-white h-34px",children:"Cancel"}),Object(m.jsx)(d.a,{onClick:function(){return I()},className:"bg-fireck-4 hover:bg-fireck-4-hover h-34px",children:x?"Loading...":"Submit"})]})]})})}):null},N=n(724),I=n(22),C=n(78),E=n(144),S=n(88),R=n.n(S);t.default=function(){var e=f.a.useState(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],u=f.a.useState([]),b=Object(s.a)(u,2),h=b[0],j=b[1],p=f.a.useState(""),v=Object(s.a)(p,2),O=v[0],g=v[1],k=f.a.useState(),w=Object(s.a)(k,2),S=w[0],z=w[1],A=Object(I.d)((function(e){return e.collectionTypes})),F=Object(C.b)(),P=Object(I.c)(),D=f.a.useState(),J=Object(s.a)(D,2),L=J[0],B=J[1],T=f.a.useState(!1),M=Object(s.a)(T,2),_=M[0],W=M[1],G=h.find((function(e){return e.docId===O})),V=!(JSON.stringify(G)===JSON.stringify(L));f.a.useEffect((function(){G&&B(JSON.parse(JSON.stringify(G)))}),[G]),f.a.useEffect((function(){Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!P){e.next=7;break}return P({type:"SET_LOADING",payload:!0}),e.next=5,Object(N.c)({collectionId:"RolesReservedCollection"});case 5:"error"in(t=e.sent)||(j(t),t.length&&g(t[0].docId));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:return e.prev=12,P({type:"SET_LOADING",payload:!1}),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})))()}),[P]),f.a.useEffect((function(){S&&a(!0)}),[S]);var q=function(){a(!1),z(void 0)},H=function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(N.e)("RolesReservedCollection",t.docId,t);case 2:"error"in(n=e.sent)?F(n.error,{variant:"error"}):(j((function(e){var n=Object(r.a)(e),c=n.findIndex((function(e){return e.docId===O}));return-1===c||(n[c]=t),n})),F("Role updated!",{variant:"success"})),q();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(N.a)("RolesReservedCollection",t);case 2:"error"in(n=e.sent)?F(n.error,{variant:"error"}):(j((function(e){return[Object(c.a)(Object(c.a)({},t),{},{docId:n.docId})].concat(Object(r.a)(e))})),F("Role created!",{variant:"success"})),q();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.a)({confirmation:"Do you really want to delete this role"});case 2:if(!e.sent){e.next=8;break}return e.next=5,Object(N.b)("RolesReservedCollection",t);case 5:e.sent.error?F("Role was not deleted",{variant:"error"}):(j((function(e){var n=Object(r.a)(e),c=n.findIndex((function(e){return e.docId===t}));return-1===c?e:(n.splice(c,1),n)})),F("Role deleted!",{variant:"success"})),q();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(y,{onCreate:U,onDelete:K,editRole:S,open:n,onSave:H,onClose:function(){a(!1),z(void 0)}}),Object(m.jsx)(l.a,{selectedEntityId:O,entity:"role",enitityPlural:"roles",onAddEntity:function(){return a(!0)},entities:h,entityButtons:Object(m.jsx)(d.a,{onClick:Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L){e.next=2;break}return e.abrupt("return");case 2:return W(!0),e.next=5,H(L);case 5:W(!1);case 6:case"end":return e.stop()}}),e)}))),noMinWidth:!0,disabled:!V||_,className:R()("mb-4 h-28px px-7",{"bg-white cursor-default text-gray-500":!V&&!_,"bg-fireck-4 hover:bg-fireck-4-hover":!(!V&&!_)}),children:_?"Saving...":V?"Save":"Saved!"}),onSelectEntity:function(e){g(e)},onInvokeEntityEdit:function(){return z(G)},entityContent:Object(m.jsx)(x,{collections:A,roleCopy:L,setRoleCopy:B})})]})}}}]);
//# sourceMappingURL=15.f9725f35.chunk.js.map