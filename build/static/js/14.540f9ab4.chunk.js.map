{"version":3,"sources":["api/collections.ts","components/PageTitle.tsx","components/Select.tsx","../node_modules/@material-ui/icons/AddRounded.js","../node_modules/@material-ui/icons/Create.js","api/roles.ts","pages/Roles/RoleEditor.tsx","pages/Roles/RoleModal.tsx","pages/Roles/index.tsx"],"names":["getAuthHeader","user","store","getState","token","getCollection","collectionId","orderBy","startAt","startAfter","where","limit","populateRef","url","window","location","origin","fetch","headers","Authorization","then","x","json","addDocument","doc","method","body","JSON","stringify","error","deleteDocument","docId","getDocument","updateDocument","collectionType","PageTitle","className","rest","classNames","WarningIcon","React","forwardRef","props","ref","size","Select","options","white","spellCheck","map","i","data-testid","value","label","title","placement","_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","default","_default","createElement","d","permissions","RoleEditor","role","collections","onSave","setEditRole","useState","roleCopy","setRoleCopy","isSaving","setIsSaving","useEffect","parse","hasBeenChanged","name","onClick","fontSize","Button","a","disabled","p","c","pi","Checkbox","classes","checked","includes","onChange","e","prev","target","perms","push","sort","b","index","findIndex","perm","splice","length","RoleModal","open","onClose","editRole","onDelete","onCreate","useFormik","onSubmit","vals","enableReinitialize","initialValues","defaultPermissions","validate","errors","values","isSubmitting","submitCount","handleChange","setFieldValue","handleSubmit","Modal","hideBackdrop","FormControlLabel","control","toLowerCase","Roles","roleModalOpen","setRoleModalOpen","roles","setRoles","selectedRole","setSelectedRole","collectionTypes","useSelector","state","notify","useNotify","dispatch","useDispatch","type","payload","res","console","log","undefined","onUpdate","newRole","variant","arr","confirm","confirmation","ind","parseInt","r"],"mappings":"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","file":"static/js/14.540f9ab4.chunk.js","sourcesContent":["import store from \"store\";\r\n\r\nconst getAuthHeader = () => {\r\n  const user = store.getState().user;\r\n  const token = user ? user.token : null;\r\n  return \"Bearer \" + token;\r\n};\r\n\r\nexport interface Document {\r\n  docId: string;\r\n  created_at: string;\r\n  [index: string]: any;\r\n}\r\n\r\nexport interface GetCollectionOptions {\r\n  collectionId: string;\r\n  orderBy?: string;\r\n  startAt?: number | string;\r\n  startAfter?: number | string;\r\n  where?: string;\r\n  limit?: number;\r\n  populateRef?: boolean;\r\n}\r\n\r\nexport const getCollection = ({\r\n  collectionId,\r\n  orderBy,\r\n  startAt,\r\n  startAfter,\r\n  where,\r\n  limit = 10,\r\n  populateRef = true,\r\n}: GetCollectionOptions) => {\r\n  const url = `${\r\n    window.location.origin\r\n  }/api/${collectionId}?limit=${limit}&populateRef=${populateRef}${\r\n    orderBy ? `&orderBy=${orderBy}` : \"\"\r\n  }${startAt ? `&startAt=${startAt}` : startAfter ? `&startAfter=${startAfter}` : \"\"}${\r\n    where ? `&where=${where}` : \"\"\r\n  }`;\r\n  return fetch(url, { headers: { Authorization: getAuthHeader() } }).then((x) => x.json());\r\n};\r\n\r\nexport const addDocument = (collectionId: string, doc: { [index: string]: any }) => {\r\n  try {\r\n    return fetch(window.location.origin + `/api/${collectionId}`, {\r\n      method: \"POST\",\r\n      headers: { Authorization: getAuthHeader() },\r\n      body: JSON.stringify(doc),\r\n    }).then((x) => x.json());\r\n  } catch (error) {\r\n    return { error };\r\n  }\r\n};\r\n\r\nexport const deleteDocument = (collectionId: string, docId: string) => {\r\n  try {\r\n    return fetch(window.location.origin + `/api/${collectionId}/${docId}`, {\r\n      method: \"DELETE\",\r\n      headers: { Authorization: getAuthHeader() },\r\n    }).then((x) => x.json());\r\n  } catch (error) {\r\n    return { error };\r\n  }\r\n};\r\n\r\nexport const getDocument = (collectionId: string, docId: string) => {\r\n  try {\r\n    return fetch(\r\n      window.location.origin + `/api/${collectionId}${docId ? `/${docId}` : \"\"}?populateRef=false`,\r\n      {\r\n        headers: { Authorization: getAuthHeader() },\r\n      }\r\n    ).then((x) => x.json());\r\n  } catch (error) {\r\n    return { error };\r\n  }\r\n};\r\n\r\nexport const updateDocument = (\r\n  collectionType: string,\r\n  docId: string,\r\n  doc: { [index: string]: any }\r\n) => {\r\n  try {\r\n    return fetch(window.location.origin + `/api/${collectionType}/${docId}`, {\r\n      method: \"PUT\",\r\n      headers: { Authorization: getAuthHeader() },\r\n      body: JSON.stringify(doc),\r\n    }).then((x) => x.json());\r\n  } catch (error) {\r\n    return { error };\r\n  }\r\n};\r\n","import classNames from \"classnames\";\r\n\r\nexport interface PageTitleProps\r\n  extends React.DetailedHTMLProps<React.HTMLAttributes<HTMLDivElement>, HTMLDivElement> {}\r\n\r\nconst PageTitle: React.FC<PageTitleProps> = ({ className, ...rest }) => {\r\n  return (\r\n    <div\r\n      {...rest}\r\n      className={classNames(\"text-27px text-white font-medium capitalize leading-none\", className)}\r\n    ></div>\r\n  );\r\n};\r\n\r\nexport default PageTitle;\r\n","import { IoAlertCircleOutline } from \"react-icons/io5\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport React, { SelectHTMLAttributes } from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nconst WarningIcon = React.forwardRef(function MyComponent(props: any, ref: any) {\r\n  return (\r\n    <div {...props} ref={ref}>\r\n      <IoAlertCircleOutline className=\"text-red-500\" size={20}></IoAlertCircleOutline>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport interface SelectProps extends SelectHTMLAttributes<HTMLSelectElement> {\r\n  className?: string;\r\n  options: { label: string; value: string | number }[];\r\n  error?: string | boolean;\r\n  white?: boolean;\r\n}\r\n\r\nconst Select: React.FC<SelectProps> = ({\r\n  className = \"\",\r\n  options,\r\n  error,\r\n  white = false,\r\n  ...props\r\n}) => {\r\n  return (\r\n    <div className={`${className} relative flex items-center`}>\r\n      <select\r\n        className={classNames(\"px-3 h-34px border-2 border-solid w-full rounded outline-none\", {\r\n          \"border-red-400\": error,\r\n          \"focus:border-blue-300\": !error,\r\n          \"border-gray-300 bg-gray-300\": !white,\r\n          \"border-white bg-white\": white,\r\n        })}\r\n        {...props}\r\n        spellCheck={false}\r\n      >\r\n        {options.map((x, i) => (\r\n          <option data-testid={`select-option-${x.value}`} key={\"opt-\" + i} value={x.value}>\r\n            {x.label}\r\n          </option>\r\n        ))}\r\n      </select>\r\n      {error ? (\r\n        <Tooltip title={error} placement=\"top\">\r\n          <WarningIcon className=\"absolute right-2 my-auto w-auto\"></WarningIcon>\r\n        </Tooltip>\r\n      ) : null}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Select;\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1z\"\n}), 'AddRounded');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"\n}), 'Create');\n\nexports.default = _default;","export type RoleType = \"admin\" | \"user\";\r\nexport type CollectionPermission =\r\n  | \"find\"\r\n  | \"find one\"\r\n  | \"count\"\r\n  | \"create\"\r\n  | \"update\"\r\n  | \"delete\"\r\n  | \"type\";\r\n\r\nexport const permissions: CollectionPermission[] = [\r\n  \"find\",\r\n  \"find one\",\r\n  \"count\",\r\n  \"create\",\r\n  \"update\",\r\n  \"delete\",\r\n  \"type\",\r\n];\r\n\r\nexport type RoleDocument = {\r\n  docId: string;\r\n  name: string;\r\n  defaultPermissions: CollectionPermission[];\r\n  permissions: { [collectionName: string]: CollectionPermission[] };\r\n};\r\n","import React from \"react\";\r\nimport Button from \"components/Button\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport { permissions, RoleDocument } from \"api/roles\";\r\nimport Create from \"@material-ui/icons/Create\";\r\nimport { CollectionType } from \"api/collectionTypes\";\r\nimport SimpleBar from \"simplebar-react\";\r\n\r\nexport interface RoleEditorProps {\r\n  role: RoleDocument;\r\n  collections: CollectionType[];\r\n  onSave: (r: RoleDocument) => void;\r\n  setEditRole: (a: RoleDocument) => void;\r\n}\r\n\r\nconst RoleEditor: React.FC<RoleEditorProps> = ({ role, collections, onSave, setEditRole }) => {\r\n  const [roleCopy, setRoleCopy] = React.useState<RoleDocument>();\r\n  const [isSaving, setIsSaving] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    if (role) {\r\n      setRoleCopy(JSON.parse(JSON.stringify(role)));\r\n    }\r\n  }, [role]);\r\n\r\n  const hasBeenChanged = !(JSON.stringify(role) === JSON.stringify(roleCopy));\r\n\r\n  return roleCopy ? (\r\n    <div className=\"bg-gray-300 p-9 rounded\">\r\n      <div className=\"flex justify-between mb-3 flex-wrap\">\r\n        <div className=\"flex mr-3 mb-4 items-center\">\r\n          <div className=\"text-2xl font-medium capitalize\">{roleCopy.name}</div>\r\n          <Create\r\n            onClick={() => {\r\n              setEditRole(roleCopy);\r\n            }}\r\n            className=\"ml-3 text-lg cursor-pointer\"\r\n            fontSize=\"inherit\"\r\n          ></Create>\r\n        </div>\r\n\r\n        <Button\r\n          onClick={async () => {\r\n            setIsSaving(true);\r\n            await onSave(roleCopy);\r\n            setIsSaving(false);\r\n          }}\r\n          disabled={!hasBeenChanged || isSaving}\r\n          className={`mb-4 ${\r\n            !hasBeenChanged && !isSaving\r\n              ? \"bg-white cursor-default text-gray-500\"\r\n              : \"bg-orange-300 hover:bg-orange-301\"\r\n          }`}\r\n        >\r\n          {isSaving ? \"Saving...\" : hasBeenChanged ? \"Save\" : \"Saved!\"}\r\n        </Button>\r\n      </div>\r\n      <SimpleBar className=\"pb-4 scrollbar-dark\">\r\n        <table className=\"w-full min-w-544px\">\r\n          <thead>\r\n            <tr>\r\n              <th></th>\r\n              {permissions.map((p, i) => (\r\n                <th className=\"font-normal pb-2\" key={p}>\r\n                  {p}\r\n                </th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {collections.map((c, i) => (\r\n              <tr key={c.docId}>\r\n                <td>\r\n                  <div className=\" max-w-135px truncate\">{c.name}</div>\r\n                </td>\r\n                {permissions.map((p, pi) => (\r\n                  <td key={p + c.docId} className=\"text-center\">\r\n                    <Checkbox\r\n                      classes={{ checked: \"text-blue-400\" }}\r\n                      checked={\r\n                        roleCopy.permissions[c.docId]\r\n                          ? roleCopy.permissions[c.docId].includes(p)\r\n                          : false\r\n                      }\r\n                      onChange={(e) =>\r\n                        setRoleCopy((prev) => {\r\n                          if (prev == null) {\r\n                            return prev;\r\n                          }\r\n                          const checked = e.target.checked;\r\n                          let perms = { ...prev.permissions };\r\n                          if (checked) {\r\n                            if (c.docId in perms) {\r\n                              perms[c.docId].push(p);\r\n                              perms[c.docId].sort((a, b) => (a > b ? 1 : a < b ? -1 : 0));\r\n                            } else {\r\n                              perms[c.docId] = [p];\r\n                            }\r\n                          } else {\r\n                            if (c.docId in perms) {\r\n                              let index = perms[c.docId].findIndex((perm) => perm === p);\r\n                              perms[c.docId].splice(index, 1);\r\n                              if (!perms[c.docId].length) {\r\n                                delete perms[c.docId];\r\n                              }\r\n                            }\r\n                          }\r\n\r\n                          return { ...prev, permissions: perms };\r\n                        })\r\n                      }\r\n                    ></Checkbox>\r\n                  </td>\r\n                ))}\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </SimpleBar>\r\n    </div>\r\n  ) : null;\r\n};\r\n\r\nexport default RoleEditor;\r\n","import Modal from \"@material-ui/core/Modal\";\r\nimport GrayInput from \"components/Input\";\r\nimport { RoleDocument, permissions } from \"api/roles\";\r\nimport React from \"react\";\r\nimport { useFormik } from \"formik\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Button from \"components/Button\";\r\n\r\nexport interface RoleModalProps {\r\n  open: boolean;\r\n  onClose: Function;\r\n  editRole: RoleDocument | undefined;\r\n  onDelete: (docId: string) => void;\r\n  onSave: (r: RoleDocument, notify?: boolean) => void;\r\n  onCreate: (r: RoleDocument) => void;\r\n}\r\n\r\nconst RoleModal: React.FC<RoleModalProps> = ({\r\n  open,\r\n  onClose,\r\n  editRole,\r\n  onDelete,\r\n  onSave,\r\n  onCreate,\r\n}) => {\r\n  const { values, errors, isSubmitting, submitCount, handleChange, setFieldValue, handleSubmit } =\r\n    useFormik<RoleDocument>({\r\n      onSubmit: async (vals) => {\r\n        vals.docId ? await onSave(vals) : await onCreate(vals);\r\n      },\r\n      enableReinitialize: true,\r\n      initialValues: editRole\r\n        ? editRole\r\n        : {\r\n            name: \"\",\r\n            defaultPermissions: [],\r\n            permissions: {},\r\n            docId: \"\",\r\n          },\r\n      validate: (vals) => {\r\n        let errors: Partial<typeof vals> = {};\r\n        if (vals.name.length === 0) {\r\n          errors.name = \"required\";\r\n        }\r\n        return errors;\r\n      },\r\n    });\r\n\r\n  return (\r\n    <Modal open={open} hideBackdrop>\r\n      <div className=\"w-full h-full flex overflow-auto bg-black bg-opacity-40\">\r\n        <div className=\"m-auto rounded bg-white max-w-644px w-full p-9\">\r\n          <div className=\"mb-9 font-medium text-2xl\">\r\n            {values.docId ? \"Edit role\" : \"Create role\"}\r\n          </div>\r\n          <div className=\"mb-9\">\r\n            <div className=\"mb-2\">Role name</div>\r\n            <GrayInput\r\n              disabled={[\"public\", \"authenticated\"].includes(values.name)}\r\n              onChange={handleChange}\r\n              name=\"name\"\r\n              value={values.name}\r\n              error={errors.name && submitCount > 0 ? errors.name : false}\r\n            ></GrayInput>\r\n          </div>\r\n          <div className=\"mb-2\">Default permissions</div>\r\n          <div className=\"flex flex-wrap mb-9\">\r\n            {permissions.map((p, i) => (\r\n              <div key={p} className=\"sm:w-1/3 w-1/2\">\r\n                <FormControlLabel\r\n                  classes={{ label: \"font-poppins line-clamp-1\" }}\r\n                  control={\r\n                    <Checkbox\r\n                      classes={{ checked: \"text-blue-300\" }}\r\n                      className=\"mr-3\"\r\n                      checked={values.defaultPermissions.includes(p)}\r\n                      onChange={(e) => {\r\n                        let perms = [...values.defaultPermissions];\r\n                        if (e.target.checked) {\r\n                          perms.push(p);\r\n                        } else {\r\n                          const index = perms.findIndex((perm) => perm === p);\r\n                          perms.splice(index, 1);\r\n                        }\r\n                        setFieldValue(\"defaultPermissions\", perms);\r\n                      }}\r\n                    ></Checkbox>\r\n                  }\r\n                  label={p}\r\n                ></FormControlLabel>\r\n              </div>\r\n            ))}\r\n          </div>\r\n          {!editRole || [\"public\", \"authenticated\"].includes(editRole.name.toLowerCase()) ? null : (\r\n            <Button\r\n              onClick={() => onDelete(editRole.docId)}\r\n              className=\"border-2 border-red-500 text-red-500 mb-10 hover:bg-red-500 hover:text-white\"\r\n            >\r\n              Delete role\r\n            </Button>\r\n          )}\r\n          <div className=\"flex justify-between\">\r\n            <Button onClick={() => onClose()} className=\"bg-blue-300 hover:bg-blue-400 text-white\">\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={() => handleSubmit()} className=\"bg-orange-300 hover:bg-orange-301\">\r\n              {isSubmitting ? \"Loading...\" : \"Submit\"}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default RoleModal;\r\n","import Button from \"components/Button\";\r\nimport React from \"react\";\r\nimport AddRounded from \"@material-ui/icons/AddRounded\";\r\nimport Select from \"components/Select\";\r\nimport RoleEditor from \"./RoleEditor\";\r\nimport RoleModal from \"./RoleModal\";\r\nimport { getCollection, updateDocument, addDocument, deleteDocument } from \"api/collections\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { RootState } from \"store\";\r\nimport { useNotify } from \"components/NotificationsProvider\";\r\nimport PageTitle from \"components/PageTitle\";\r\nimport { RoleDocument } from \"api/roles\";\r\nimport { confirm } from \"components/Confirm\";\r\n\r\nexport interface RolesProps {}\r\n\r\nconst Roles: React.FC<RolesProps> = () => {\r\n  const [roleModalOpen, setRoleModalOpen] = React.useState(false);\r\n  const [roles, setRoles] = React.useState<RoleDocument[]>([]);\r\n  const [selectedRole, setSelectedRole] = React.useState(0);\r\n  const [editRole, setEditRole] = React.useState<RoleDocument>();\r\n  const collectionTypes = useSelector((state: RootState) => state.collectionTypes);\r\n  const notify = useNotify();\r\n  const dispatch = useDispatch();\r\n\r\n  React.useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        if (dispatch) {\r\n          dispatch({ type: \"SET_LOADING\", payload: true });\r\n          const res = await getCollection({ collectionId: \"RolesReservedCollection\" });\r\n          if (!(\"error\" in res)) {\r\n            setRoles(res);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.log(error);\r\n      } finally {\r\n        dispatch({ type: \"SET_LOADING\", payload: false });\r\n      }\r\n    })();\r\n  }, [dispatch]);\r\n\r\n  React.useEffect(() => {\r\n    if (editRole) {\r\n      setRoleModalOpen(true);\r\n    }\r\n  }, [editRole]);\r\n\r\n  const onClose = () => {\r\n    setRoleModalOpen(false);\r\n    setEditRole(undefined);\r\n  };\r\n\r\n  const onUpdate = async (newRole: RoleDocument) => {\r\n    const res = await updateDocument(\"RolesReservedCollection\", newRole.docId, newRole);\r\n    if (!(\"error\" in res)) {\r\n      setRoles((prev) => {\r\n        let arr = [...prev];\r\n        arr[selectedRole] = newRole;\r\n        return arr;\r\n      });\r\n      notify(\"Role updated!\", { variant: \"success\" });\r\n    } else {\r\n      notify(res.error, { variant: \"error\" });\r\n    }\r\n    onClose();\r\n  };\r\n\r\n  const onCreate = async (newRole: RoleDocument) => {\r\n    const res = await addDocument(\"RolesReservedCollection\", newRole);\r\n    if (!(\"error\" in res)) {\r\n      setRoles((prev) => [{ ...newRole, docId: res.docId }, ...prev]);\r\n      notify(\"Role created!\", { variant: \"success\" });\r\n    } else {\r\n      notify(res.error, { variant: \"error\" });\r\n    }\r\n    onClose();\r\n  };\r\n\r\n  const onDelete = async (docId: string) => {\r\n    if (\r\n      await confirm({\r\n        confirmation: \"Do you really want to delete this role\",\r\n      })\r\n    ) {\r\n      let res = await deleteDocument(\"RolesReservedCollection\", docId);\r\n      if (!res.error) {\r\n        setRoles((prev) => {\r\n          let arr = [...prev];\r\n          const ind = arr.findIndex((x) => x.docId === docId);\r\n          if (ind === -1) return prev;\r\n          arr.splice(ind, 1);\r\n          return arr;\r\n        });\r\n        notify(\"Role deleted!\", { variant: \"success\" });\r\n      } else {\r\n        notify(\"Role was not deleted\", { variant: \"error\" });\r\n      }\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"flex flex-wrap justify-between mb-6\">\r\n        <PageTitle className=\"mb-4 mr-4\">Roles</PageTitle>\r\n        <Button\r\n          onClick={() => setRoleModalOpen(true)}\r\n          className=\"bg-orange-300 hover:bg-orange-301 mb-4\"\r\n        >\r\n          <div className=\"flex items-center\">\r\n            <AddRounded className=\"mr-3 text-lg\" fontSize=\"inherit\"></AddRounded>\r\n            <span>Create role</span>\r\n          </div>\r\n        </Button>\r\n        <RoleModal\r\n          onCreate={onCreate}\r\n          onDelete={onDelete}\r\n          editRole={editRole}\r\n          open={roleModalOpen}\r\n          onSave={onUpdate}\r\n          onClose={() => {\r\n            setRoleModalOpen(false);\r\n            setEditRole(undefined);\r\n          }}\r\n        ></RoleModal>\r\n      </div>\r\n      <div className=\"flex flex-wrap lg:flex-nowrap\">\r\n        <div className=\"max-w-192px mb-3 mr-4 block lg:hidden w-full\">\r\n          <Select\r\n            onChange={(e) => setSelectedRole(parseInt(e.target.value))}\r\n            value={selectedRole}\r\n            options={roles.map((x, i) => ({ label: x.name, value: i }))}\r\n          ></Select>\r\n        </div>\r\n\r\n        <div className=\"max-w-192px w-full flex-shrink-0 mr-4 hidden lg:block\">\r\n          {roles.map((x, i) => (\r\n            <div\r\n              onClick={() => setSelectedRole(i)}\r\n              key={`collection-${i}`}\r\n              className={`mb-1 capitalize truncate cursor-pointer ${\r\n                selectedRole === i ? \"bg-orange-300\" : \"hover:bg-gray-300\"\r\n              } rounded h-34px leading-34px px-3`}\r\n            >\r\n              {x.name}\r\n            </div>\r\n          ))}\r\n        </div>\r\n        {selectedRole < roles.length ? (\r\n          <div className=\"lg:flex-grow w-full lg:w-0\">\r\n            <RoleEditor\r\n              setEditRole={(r) => setEditRole(r)}\r\n              role={roles[selectedRole]}\r\n              collections={collectionTypes}\r\n              onSave={onUpdate}\r\n            ></RoleEditor>\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Roles;\r\n"],"sourceRoot":""}